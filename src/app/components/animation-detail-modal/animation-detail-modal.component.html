<ion-header>
  <ion-toolbar>
    <ion-title>{{ animation.name }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="close()">
        <ion-icon name="close" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="animation-detail">
    
    <!-- Creator Info -->
    <div class="creator-section">
      <div class="creator-info">
        <ion-avatar *ngIf="animation.creatorPhotoURL" class="creator-avatar">
          <img [src]="animation.creatorPhotoURL" [alt]="animation.creatorName">
        </ion-avatar>
        <ion-avatar *ngIf="!animation.creatorPhotoURL" class="creator-avatar">
          <ion-icon name="person-outline"></ion-icon>
        </ion-avatar>
        <div class="creator-details">
          <h3>{{ animation.creatorName || 'Anonymous' }}</h3>
          <p class="creator-date">{{ formatDate(animation.sharedAt || animation.createdAt) }}</p>
        </div>
      </div>
      <div class="animation-stats">
        <div class="stat-item">
          <ion-icon name="heart-outline"></ion-icon>
          <span>{{ animation.likes || 0 }}</span>
        </div>
        <div class="stat-item">
          <ion-icon name="download-outline"></ion-icon>
          <span>{{ animation.downloads || 0 }}</span>
        </div>
      </div>
    </div>

    <!-- Animation Preview -->
    <div class="preview-section">
      <div class="preview-header">
        <h3>Preview</h3>
        <ion-button
          fill="clear"
          size="small"
          (click)="toggleCodeView()"
        >
          <ion-icon [name]="showCode ? 'eye-outline' : 'code-outline'" slot="start"></ion-icon>
          {{ showCode ? 'Show Preview' : 'Show Code' }}
        </ion-button>
      </div>

      <!-- LED Grid Preview -->
      <div *ngIf="!showCode" class="preview-container">
        <div class="led-grid">
          <div
            *ngFor="let led of ledGrid; let i = index"
            class="led-cell"
            [class.active]="led"
          ></div>
        </div>

        <!-- Playback Controls -->
        <div class="playback-controls">
          <ion-button fill="clear" (click)="stepBackward()">
            <ion-icon name="play-skip-back-outline"></ion-icon>
          </ion-button>
          <ion-button fill="solid" (click)="isPlaying ? pauseAnimation() : playAnimation()">
            <ion-icon [name]="isPlaying ? 'pause' : 'play'"></ion-icon>
          </ion-button>
          <ion-button fill="clear" (click)="stopAnimation()">
            <ion-icon name="stop"></ion-icon>
          </ion-button>
          <ion-button fill="clear" (click)="stepForward()">
            <ion-icon name="play-skip-forward-outline"></ion-icon>
          </ion-button>
        </div>

        <div class="frame-info">
          Frame {{ currentFrameIndex + 1 }} / {{ animation.frames?.length || 0 }}
          <span *ngIf="animation.frameRate"> â€¢ {{ animation.frameRate }}ms</span>
        </div>
      </div>

      <!-- Code View -->
      <div *ngIf="showCode" class="code-container">
        <pre><code>{{ animation.code }}</code></pre>
      </div>
    </div>

    <!-- Animation Details -->
    <div class="details-section">
      <h3>Details</h3>
      <div class="detail-item">
        <span class="detail-label">Frames:</span>
        <span class="detail-value">{{ animation.frames?.length || 0 }}</span>
      </div>
      <div class="detail-item" *ngIf="animation.frameRate">
        <span class="detail-label">Frame Rate:</span>
        <span class="detail-value">{{ animation.frameRate }}ms</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Type:</span>
        <span class="detail-value">{{ animation.codeType || 'json' }}</span>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <ion-button
        expand="block"
        fill="solid"
        (click)="useAnimation()"
        class="use-button"
      >
        <ion-icon name="add-outline" slot="start"></ion-icon>
        Use This Animation
      </ion-button>
      <ion-button
        expand="block"
        fill="outline"
        (click)="close()"
      >
        Close
      </ion-button>
    </div>

  </div>
</ion-content>

